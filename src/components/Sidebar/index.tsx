"use client";

import React, { useEffect, useRef, useState } from "react";
import { usePathname } from "next/navigation";
import Link from "next/link";
import Image from "next/image";
import SidebarItem from "@/components/Sidebar/SidebarItem";
import ClickOutside from "@/components/ClickOutside";
import useLocalStorage from "@/hooks/useLocalStorage";

interface SidebarProps {
  sidebarOpen: boolean;
  setSidebarOpen: (arg: boolean) => void;
}

const menuGroups = [
  {
    menuItems: [
      {
        icon: (
          <svg
            className="fill-current"
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
          >
            <rect
              x="4"
              y="4"
              width="6"
              height="6"
              rx="1"
              stroke="#33363F"
              stroke-width="2"
              stroke-linejoin="round"
            />
            <rect
              x="4"
              y="14"
              width="6"
              height="6"
              rx="1"
              stroke="#33363F"
              stroke-width="2"
              stroke-linejoin="round"
            />
            <rect
              x="14"
              y="14"
              width="6"
              height="6"
              rx="1"
              stroke="#33363F"
              stroke-width="2"
              stroke-linejoin="round"
            />
            <rect
              x="14"
              y="4"
              width="6"
              height="6"
              rx="1"
              stroke="#33363F"
              stroke-width="2"
              stroke-linejoin="round"
            />
          </svg>
        ),
        label: "Dashboard",
        route: "/",
      },
      {
        icon: (
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="22"
            height="22"
            viewBox="0 0 640 512"
            fill="currentColor"
          >
            <path d="M96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM0 482.3C0 383.8 79.8 304 178.3 304l91.4 0C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7L29.7 512C13.3 512 0 498.7 0 482.3zM609.3 512l-137.8 0c5.4-9.4 8.6-20.3 8.6-32l0-8c0-60.7-27.1-115.2-69.8-151.8c2.4-.1 4.7-.2 7.1-.2l61.4 0C567.8 320 640 392.2 640 481.3c0 17-13.8 30.7-30.7 30.7zM432 256c-31 0-59-12.6-79.3-32.9C372.4 196.5 384 163.6 384 128c0-26.8-6.6-52.1-18.3-74.3C384.3 40.1 407.2 32 432 32c61.9 0 112 50.1 112 112s-50.1 112-112 112z"/>
          </svg>
        ),
        label: "Users",
        route: "/users",
      },
      {
        icon: (
          <svg
            className="fill-current"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 35 35"
            fill="none"
          >
            <path
              d="M17.5 2.91663L22.0062 12.0458L32.0833 13.5187L24.7917 20.6208L26.5125 30.6541L17.5 25.9145L8.48749 30.6541L10.2083 20.6208L2.91666 13.5187L12.9937 12.0458L17.5 2.91663Z"
              stroke=""
              stroke-width="4"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        ),
        label: "Farms",
        route: "/farms",
      },
      {
        icon: (
          <svg
            className="fill-current"
            xmlns="http://www.w3.org/2000/svg"
            width="22"
            height="22"
            viewBox="0 0 512 512"
            fill="none"
          >
            <path d="M505 41c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0L383 95c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l88-88zM305.5 27.3c-6.2-6.2-16.4-6.2-22.6 0L271.5 38.6c-37.5 37.5-37.5 98.3 0 135.8l10.4 10.4-30.5 30.5c-3.4-27.3-15.5-53.8-36.5-74.8l-11.3-11.3c-6.2-6.2-16.4-6.2-22.6 0l-11.3 11.3c-37.5 37.5-37.5 98.3 0 135.8l10.4 10.4-30.5 30.5c-3.4-27.3-15.5-53.8-36.5-74.8L101.8 231c-6.2-6.2-16.4-6.2-22.6 0L67.9 242.3c-37.5 37.5-37.5 98.3 0 135.8l10.4 10.4L9.4 457.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l68.9-68.9 12.2 12.2c37.5 37.5 98.3 37.5 135.8 0l11.3-11.3c6.2-6.2 6.2-16.4 0-22.6l-11.3-11.3c-21.8-21.8-49.6-34.1-78.1-36.9l31.9-31.9 12.2 12.2c37.5 37.5 98.3 37.5 135.8 0l11.3-11.3c6.2-6.2 6.2-16.4 0-22.6l-11.3-11.3c-21.8-21.8-49.6-34.1-78.1-36.9l31.9-31.9 12.2 12.2c37.5 37.5 98.3 37.5 135.8 0L486.5 231c6.2-6.2 6.2-16.4 0-22.6L475.2 197c-5.2-5.2-10.6-9.8-16.4-13.9L505 137c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-59.4 59.4c-20.6-4.4-42-3.7-62.3 2.1c6.1-21.3 6.6-43.8 1.4-65.3L409 41c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0L329.1 52.9c-3.7-5-7.8-9.8-12.4-14.3L305.5 27.3z"/>
          </svg>

        ),
        label: "Produce",
        route: "/produce",
      },
      {
        icon: (
          <svg
            className="fill-current"
            xmlns="http://www.w3.org/2000/svg"
            width="22"
            height="22"
            viewBox="0 0 31 31"
            fill=""
          >
            <path
              d="M19.6282 7.6615H22.6801L22.6276 5.8025H20.0477L22.4724 0.791286L19.7292 0.561741L17.3198 2.40861L18.1232 0.320071L15.3114 0L14.3892 2.60987L12.8737 0.589221L8.70483 0.444543L11.4633 5.80331L8.97316 5.72329V7.66069H11.3728C6.25506 10.6561 2.56787 18.4857 2.56787 22.7153C2.56787 28.0175 8.35809 31 15.4997 31C22.6413 31 28.4315 28.0175 28.4315 22.7153C28.4323 18.4857 24.7459 10.6569 19.6282 7.6615ZM16.5811 25.2589V27.0945H14.8167V25.385C13.6108 25.3325 12.4405 25.0059 11.7567 24.6115L12.2966 22.5068C13.0523 22.9214 14.1152 23.2981 15.2847 23.2981C16.3104 23.2981 17.0127 22.902 17.0127 22.1835C17.0127 21.4973 16.4372 21.0649 15.1053 20.6163C13.1784 19.9689 11.865 19.0677 11.865 17.3234C11.865 15.7392 12.9812 14.4961 14.9073 14.1195V12.4092H16.6716V13.9934C17.8767 14.0484 18.6882 14.2981 19.2814 14.5867L18.7593 16.6211C18.2913 16.4238 17.4629 16.0084 16.1673 16.0084C14.997 16.0084 14.6187 16.5119 14.6187 17.0155C14.6187 17.6104 15.2491 17.9878 16.7791 18.5641C18.9202 19.3223 19.785 20.31 19.785 21.9313C19.7858 23.5309 18.651 24.8993 16.5811 25.2589Z"
              fill=""
            />
          </svg>
        ),
        label: "Orders",
        route: "/orders",
      },

      {
        icon: (
          <svg
            className="fill-current"
            xmlns="http://www.w3.org/2000/svg"
            width="22"
            height="19"
            viewBox="0 0 26 19"
            fill="none"
          >
            <path
              d="M19.8333 16.9167C19.3692 16.9167 18.9241 16.7323 18.5959 16.4041C18.2677 16.0759 18.0833 15.6308 18.0833 15.1667C18.0833 14.7025 18.2677 14.2574 18.5959 13.9292C18.9241 13.601 19.3692 13.4167 19.8333 13.4167C20.2975 13.4167 20.7426 13.601 21.0708 13.9292C21.399 14.2574 21.5833 14.7025 21.5833 15.1667C21.5833 15.6308 21.399 16.0759 21.0708 16.4041C20.7426 16.7323 20.2975 16.9167 19.8333 16.9167ZM21.5833 6.41667L23.87 9.33333H18.6667V6.41667H21.5833ZM5.83333 16.9167C5.3692 16.9167 4.92408 16.7323 4.5959 16.4041C4.26771 16.0759 4.08333 15.6308 4.08333 15.1667C4.08333 14.7025 4.26771 14.2574 4.5959 13.9292C4.92408 13.601 5.3692 13.4167 5.83333 13.4167C6.29746 13.4167 6.74258 13.601 7.07077 13.9292C7.39896 14.2574 7.58333 14.7025 7.58333 15.1667C7.58333 15.6308 7.39896 16.0759 7.07077 16.4041C6.74258 16.7323 6.29746 16.9167 5.83333 16.9167ZM22.1667 4.66667H18.6667V0H2.33333C1.03833 0 0 1.03833 0 2.33333V15.1667H2.33333C2.33333 16.0949 2.70208 16.9852 3.35846 17.6415C4.01484 18.2979 4.90508 18.6667 5.83333 18.6667C6.76159 18.6667 7.65183 18.2979 8.30821 17.6415C8.96458 16.9852 9.33333 16.0949 9.33333 15.1667H16.3333C16.3333 16.0949 16.7021 16.9852 17.3585 17.6415C18.0148 18.2979 18.9051 18.6667 19.8333 18.6667C20.7616 18.6667 21.6518 18.2979 22.3082 17.6415C22.9646 16.9852 23.3333 16.0949 23.3333 15.1667H25.6667V9.33333L22.1667 4.66667Z"
              fill="#"
            />
          </svg>
        ),
        label: "Vehicles",
        route: "/vehicles",
      },
      // {
      //   icon: (
      //     <svg
      //       className="fill-current"
      //       xmlns="http://www.w3.org/2000/svg"
      //       width="22"
      //       height="22"
      //       viewBox="0 0 31 31"
      //       fill=""
      //     >
      //       <path
      //         d="M19.6282 7.6615H22.6801L22.6276 5.8025H20.0477L22.4724 0.791286L19.7292 0.561741L17.3198 2.40861L18.1232 0.320071L15.3114 0L14.3892 2.60987L12.8737 0.589221L8.70483 0.444543L11.4633 5.80331L8.97316 5.72329V7.66069H11.3728C6.25506 10.6561 2.56787 18.4857 2.56787 22.7153C2.56787 28.0175 8.35809 31 15.4997 31C22.6413 31 28.4315 28.0175 28.4315 22.7153C28.4323 18.4857 24.7459 10.6569 19.6282 7.6615ZM16.5811 25.2589V27.0945H14.8167V25.385C13.6108 25.3325 12.4405 25.0059 11.7567 24.6115L12.2966 22.5068C13.0523 22.9214 14.1152 23.2981 15.2847 23.2981C16.3104 23.2981 17.0127 22.902 17.0127 22.1835C17.0127 21.4973 16.4372 21.0649 15.1053 20.6163C13.1784 19.9689 11.865 19.0677 11.865 17.3234C11.865 15.7392 12.9812 14.4961 14.9073 14.1195V12.4092H16.6716V13.9934C17.8767 14.0484 18.6882 14.2981 19.2814 14.5867L18.7593 16.6211C18.2913 16.4238 17.4629 16.0084 16.1673 16.0084C14.997 16.0084 14.6187 16.5119 14.6187 17.0155C14.6187 17.6104 15.2491 17.9878 16.7791 18.5641C18.9202 19.3223 19.785 20.31 19.785 21.9313C19.7858 23.5309 18.651 24.8993 16.5811 25.2589Z"
      //         fill=""
      //       />
      //     </svg>
      //   ),
      //   label: "Transactions",
      //   route: "/transactions",
      // },
      {
        icon: (

          <svg 
            xmlns="http://www.w3.org/2000/svg" 
            width="24"
            height="24"
            viewBox="0 0 512 512"
            fill="currentColor"
          >
            <path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 208c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-176c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 272c0 1.5 0 3.1 .1 4.6L67.6 283c-16-15.2-41.3-14.6-56.6 1.4s-14.6 41.3 1.4 56.6L124.8 448c43.1 41.1 100.4 64 160 64l19.2 0c97.2 0 176-78.8 176-176l0-208c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 112c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-176c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 176c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-208z"/>
          </svg>          
        ),
        label: "Bids",
        route: "/bids",
      },
    ],
  },
];

const Sidebar = ({ sidebarOpen, setSidebarOpen }: SidebarProps) => {
  const pathname = usePathname();
  const [pageName, setPageName] = useLocalStorage("selectedMenu", "dashboard");

  return (
    <ClickOutside onClick={() => setSidebarOpen(false)}>
      <aside
        className={`fixed left-0 top-0 z-9999 flex h-screen w-72.5 flex-col overflow-y-hidden bg-stroke duration-300 ease-linear dark:bg-boxdark lg:translate-x-0 ${
          sidebarOpen ? "translate-x-0" : "-translate-x-full"
        }`}
      >
        {/* <!-- SIDEBAR HEADER --> */}
        <div className="mx-auto px-6 py-5.5 lg:py-6.5">
          <Link href="/">
            <Image
              width={60}
              height={32}
              src={"/images/logo/useri-logo.svg"}
              alt="Logo"
              priority
            />
          </Link>

          <button
            onClick={() => setSidebarOpen(!sidebarOpen)}
            aria-controls="sidebar"
            className="block lg:hidden"
          >
            <svg
              className="fill-current"
              width="20"
              height="18"
              viewBox="0 0 20 18"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M19 8.175H2.98748L9.36248 1.6875C9.69998 1.35 9.69998 0.825 9.36248 0.4875C9.02498 0.15 8.49998 0.15 8.16248 0.4875L0.399976 8.3625C0.0624756 8.7 0.0624756 9.225 0.399976 9.5625L8.16248 17.4375C8.31248 17.5875 8.53748 17.7 8.76248 17.7C8.98748 17.7 9.17498 17.625 9.36248 17.475C9.69998 17.1375 9.69998 16.6125 9.36248 16.275L3.02498 9.8625H19C19.45 9.8625 19.825 9.4875 19.825 9.0375C19.825 8.55 19.45 8.175 19 8.175Z"
                fill=""
              />
            </svg>
          </button>
        </div>
        {/* <!-- SIDEBAR HEADER --> */}

        <div className="no-scrollbar flex flex-col overflow-y-auto duration-300 ease-linear">
          {/* <!-- Sidebar Menu --> */}
          <nav className="mt-5 px-4 py-4 lg:mt-9 lg:px-6">
            <div>
              <ul className="mb-6 flex flex-col gap-1.5">
                {menuGroups[0].menuItems.map((menuItem, menuIndex) => (
                  <SidebarItem
                    key={menuIndex}
                    item={menuItem}
                    pageName={pageName}
                    setPageName={setPageName}
                  />
                ))}
              </ul>
            </div>
          </nav>
          {/* <!-- Sidebar Menu --> */}
        </div>
      </aside>
    </ClickOutside>
  );
};

export default Sidebar;
